{% extends 'base.html' %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<div class="container-md p-3 mb-3 bg-body-tertiary rounded">
    <ul class="nav nav-pills mb-4" id="pills-tab" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="pills-general-tab" data-bs-toggle="pill" data-bs-target="#pills-general" type="button" role="tab" aria-controls="pills-general" aria-selected="true">General</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="pills-specialization-tab" data-bs-toggle="pill" data-bs-target="#pills-specialization" type="button" role="tab" aria-controls="pills-specialization" aria-selected="false">Specialization</button>
        </li>
    </ul>  
    <div class="tab-content" id="pills-tabContent">
        <div class="tab-pane fade show active" id="pills-general" role="tabpanel" aria-labelledby="pills-general-tab" tabindex="0">
            {% from "_formhelpers.html" import render_field %}
            <div class="container ">
                <div class="h5 mt-3 mb-3">Account Details</div>
                <div class="mx-4">
                    <div class="row">
                        <div class="col-md ">
                            {{ render_field(form.username, class="form-control", placeholder=g.user.username, disabled=True) }}
                            <div class="text-center">
                                <div class="text-danger mb-1" id="uname-message"></div>
                                <span><button type="button" class="btn btn-primary m-1" id="edit-uname-button">Change Username</button></span>
                                <span><button type="submit" class="btn btn-primary m-1" id="submit-uname-button" data-url="{{ url_for('doc.change_uname') }}" hidden disabled>Save Changes</button></span>
                            </div>
                        </div>
                        <div class="col-md">
                            {{ render_field(form.password, class="form-control", placeholder="******", disabled=True) }}
                            <div class="text-center">
                                <span><a href="{{ url_for('auth.change_pass', user_type = session.get('user_type'), id = g.user.id) }}" class="btn btn-primary m-1">Change Password</a></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <form method="post" action="{{ url_for('doc.change_details') }}">
                <div class="container ">
                    <div class="h5 mt-3 mb-3">Personal Information</div>
                    <div class="mx-4" id="personal-info">
                        {{ render_field(form.full_name, class="form-control", placeholder=g.user.full_name, disabled=True) }}
                        <div class="row">
                            <div class="col-md">
                                {{ render_field(form.gender, class="form-control", data_selected_option=g.user.gender, disabled=True) }}
                            </div>
                            <div class="col-md">
                                {{ render_field(form.dob, class="form-control", data_selected_date=g.user.dob | date, disabled=True) }}
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md">
                                {{ render_field(form.email, class="form-control", placeholder=g.user.email, disabled=True) }}
                            </div>
                            <div class="col-md">
                                {{ render_field(form.contact, class="form-control", placeholder=g.user.contact | phone_no, disabled=True) }}
                            </div>
                        </div>
                    </div>
                    <div class=" text-center">
                        <span><button type="button" class="btn btn-primary m-1" id="edit-button">Edit Details</button></span>
                        <span><button type="submit" class="btn btn-primary m-1" id="save-button" hidden disabled>Save Changes</button></span>
                    </div>
                </div>
            </form>
        </div>
        <div class="tab-pane fade" id="pills-specialization" role="tabpanel" aria-labelledby="pills-specialization-tab" tabindex="0">
            <div class="mx-4 mb-3">
                <div class="vstack gap-2 align-items-center">
                    <div class="text-start">
                        {{ render_field(form2.specialization, class="form-control", style="width: 50dvw;") }}
                    </div>
                    <div class="text-danger mb-1" id="specialization-message"></div>
                    <button type="button" class="btn btn-outline-primary mb-3" style="width: 25dvw;" id="add-specialization" data-add-url="{{ url_for('doc.add_specialization') }}">Add</button>
                </div>
                <div class="mt-2 table-responsive-sm row justify-content-center">
                    <table class="table table-striped details-table" id="specialization-table" style="width: 50dvw;">
                        <thead>
                            <tr>
                                <th scope="col">#</th>
                                <th scope="col">Specialization</th>
                                <th scope="col"></th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for specialization in specializations %}
                            <tr data-id="{{ specialization.Specialization.id }}">
                                <td scope="row">{{ specialization.Specialization.id }}</td>
                                <td>{{ specialization.Specialization.specialization }}</td>
                                <td><button type="button" class="btn-close remove-button float-end" data-remove-url="{{ url_for('doc.add_specialization_remove') }}"></button></td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="{{ url_for('static', filename='/js/doc_profile.js') }}"></script>
<script src="{{ url_for('static', filename='/js/doc_add_specialization.js') }}"></script>
{% endblock %}